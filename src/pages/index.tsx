// import * as React from 'react'
import type { NextPage } from 'next'
import MainLayout from '../layouts'
import Head from 'next/head'
import Image from 'next/image'
import styles from '../styles/Home.module.scss'
// import { Media } from "../components/media"

import React, { useState, useEffect } from 'react'
//todosã®getHelloãƒ¡ã‚½ãƒƒãƒ‰ä½¿ã£ã¦ã‚‹ã‹ã‚‰
import { getHello, deleteHello, updateHello } from '../lib/api/hellos'
import Type from '../types'

import Test from '../components/counter'

import TodoList from '../components/todoList'

const Home: NextPage = () => {
  // const useMedia = Media();
  // useStateã§stateã‚’è¨­å®šã€<Type['helloObj']>ã¯importã•ã‚ŒãŸTypeã®ä¸­ã®helloObjã‚’å‚ç…§
  // typescriptã§ã¯id, title, textã®å‹ã‚’è¨­å®šã—ã¦ã‚‹ã®ã§å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸå€¤ã‚’å…¥ã‚Œã‚‹
  const [helloData, setText] = useState<Type['helloObj']>({
    id: 0,
    title: '',
    text: '',
  })

  // FIXME:axiosã®ç›´æ›¸ãã“ã“ã«æããŸããªã„ãªãƒ¼ã©ã†ã«ã‹ãªã‚‰ã‚“ã‹ãª
  // ãƒ‡ãƒ¼ã‚¿å¤‰æ›´ç”¨(stateç”¨)ã®ãƒ•ã‚¡ã‚¤ãƒ«ä½œã£ãŸæ–¹ãŒã„ã„æ°—ãŒã™ã‚‹
  // è¡¨ç¤ºã¨ãƒ‡ãƒ¼ã‚¿æ›´æ–°ä¸€ç·’ã«ã™ã‚‹ã®æ€–ã„

  // handlegetHelloé–¢æ•°ã‚’è¨­å®šaxiosã§ãƒ‡ãƒ¼ã‚¿ã‚’å–ã£ã¦ãã¦try catchã§responseã‚’è¿”ã—ã¦ã„ã‚‹
  const handlegetHello = async () => {
    try {
      const res = await getHello()
      if (res?.status === 200) {
        console.log('============ return status 200')
        // setTextã§helloDataã®stateã‚’å¤‰æ›´ã€å€¤ã¯å¼•æ•°ã®res.data.text
        setText(res.data)
      } else {
        console.log('============ return else')
        console.log(res.data.text)
      }
    } catch (err) {
      console.log('============ catch error')
      console.log(err)
    }
  }

  const handledeleteHello = async (id: number) => {
    try {
      // ã“ã‚Œã§idã‚’paramsã«æŒã£ã¦serverã«ã„ã
      const res = await deleteHello(id)
      if (res?.status === 200) {
        console.log('============ return status 200')
        // setTextã§helloDataã®stateã‚’å¤‰æ›´ã€å€¤ã¯å¼•æ•°ã®res.data.text
        // ä¾‹) setTodos((prev: Todo[]) => prev.filter((todo: Todo) => todo.id !== id))
        // setText()ã®ä¸­ã«filterã‚’æ›¸ãã€ãªã‚“ã‹ã¡ã‚‡ã£ã¨æãæ–¹é•ã†ï¼Ÿ
        // ã“ã“ã®å‹æŒ‡å®šã‚ã£ã¦ã‚‹ï¼Ÿ
        const deleteHello = { id: 0, title: '', text: '' }
        setText(deleteHello)
      } else {
        console.log('============ return else')
      }
    } catch (err) {
      console.log('============ catch error')
      console.log(err)
    }
  }

  const handleupdateHello = async (data: Type['helloObj']) => {
    try {
      // ã“ã‚Œã§idã‚’paramsã«æŒã£ã¦serverã«ã„ã
      const res = await updateHello(data)
      if (res?.status === 200) {
        console.log('============ return status 200')
        // setTextã§helloDataã®stateã‚’å¤‰æ›´ã€å€¤ã¯å¼•æ•°ã®res.data.text
        // ä¾‹) setTodos((prev: Todo[]) => prev.filter((todo: Todo) => todo.id !== id))
        // setText()ã®ä¸­ã«filterã‚’æ›¸ãã€ãªã‚“ã‹ã¡ã‚‡ã£ã¨æãæ–¹é•ã†ï¼Ÿ
        // ã“ã“ã®å‹æŒ‡å®šã‚ã£ã¦ã‚‹ï¼Ÿ
        //
        data.title = 'ã“ã‚“ã«ã¡ã¯update!'
        const setData = {
          id: data.id,
          title: data.title,
          text: data.text,
        }
        setText(setData)
      } else {
        console.log('============ return else')
      }
    } catch (err) {
      console.log('============ catch error')
      console.log(err)
    }
  }

  // DOMã®æç”»æ™‚(Vueã§ã„ã†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°)ã«useEffectç™ºç«
  // useEffectç™ºç«ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°â†’ã•ã¾ã–ã¾ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ç™ºç«ã§ãã‚‹ï¼Ÿ
  // åˆå›ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã®ã¿å®Ÿè¡Œã™ã‚‹â†’ç¬¬äºŒå¼•æ•°ã®é…åˆ—ã‚’ç©ºã«ã—ã¦è¨˜è¿°
  // ä»»æ„ã®å¤‰æ•°ãŒå¤‰åŒ–ã—ãŸã¨ãã®ã¿å®Ÿè¡Œâ†’ç¬¬äºŒå¼•æ•°ã®é…åˆ—ã«ãã®å¤‰æ•°ã‚’æŒ‡å®š
  // ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¯Vueã¨é•ã†ã¿ãŸã„
  useEffect(() => {
    handlegetHello()
  }, [])

  return (
    <MainLayout>
      <div className={styles.container}>
        <Head>
          <title>Create Next App</title>
          <meta name="description" content="Generated by create next app" />
          <link rel="icon" href="/favicon.ico" />
        </Head>

        <main className={styles.main}>
          <h1 className={styles.title}>
            Welcome to <a href="https://nextjs.org">Next.js!</a>
          </h1>

          {/*
        <div>Screen is wide: {useMedia.isMobileSite ? "ğŸ˜ƒ" : "ğŸ˜¢"}</div>
  */}
          <h1>apiã‹ã‚‰é€ã‚‰ã‚ŒãŸid:{helloData.id}</h1>
          <h1>apiã‹ã‚‰é€ã‚‰ã‚ŒãŸtitle:{helloData.title}</h1>
          <h1>apiã‹ã‚‰é€ã‚‰ã‚ŒãŸtext:{helloData.text}</h1>

          <Test />
          <TodoList />
          <h1>ã“ã‚ŒãŒupdateã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã™</h1>
          <button onClick={() => handleupdateHello(helloData || {})}>
            Update
          </button>

          <h1>ã“ã‚ŒãŒdeleteã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã™</h1>
          <button onClick={() => handledeleteHello(helloData.id || 0)}>
            Delete
          </button>

          <p className={styles.description}>
            Get started by editing{' '}
            <code className={styles.code}>pages/index.tsx</code>
          </p>

          <div className={styles.grid}>
            <a href="https://nextjs.org/docs" className={styles.card}>
              <h2>Documentation &rarr;</h2>
              <p>Find in-depth information about Next.js features and API.</p>
            </a>

            <a href="https://nextjs.org/learn" className={styles.card}>
              <h2>Learn &rarr;</h2>
              <p>Learn about Next.js in an interactive course with quizzes!</p>
            </a>

            <a
              href="https://github.com/vercel/next.js/tree/canary/examples"
              className={styles.card}
            >
              <h2>Examples &rarr;</h2>
              <p>Discover and deploy boilerplate example Next.js projects.</p>
            </a>

            <a
              href="https://vercel.com/new?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
              className={styles.card}
            >
              <h2>Deploy &rarr;</h2>
              <p>
                Instantly deploy your Next.js site to a public URL with Vercel.
              </p>
            </a>
          </div>
        </main>

        <footer className={styles.footer}>
          <a
            href="https://vercel.com?utm_source=create-next-app&utm_medium=default-template&utm_campaign=create-next-app"
            target="_blank"
            rel="noopener noreferrer"
          >
            Powered by{' '}
            <span className={styles.logo}>
              <Image
                src="/vercel.svg"
                alt="Vercel Logo"
                width={72}
                height={16}
              />
            </span>
          </a>
        </footer>
      </div>
    </MainLayout>
  )
}

export default Home
